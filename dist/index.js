!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.mglue=e():t.mglue=e()}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=14)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.getPerson=function(t){return{name:t}},t}();e.Dummy=n;var i=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.set=function(e,r){e instanceof t?(this.x=e.x,this.y=e.y):(this.x=e,this.y=r)},t.distance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t.prototype.directionTo=function(t){return 180*Math.atan2(t.x-this.x,-(t.y-this.y))/Math.PI},t.prototype.rotation=function(){return 180*Math.atan2(this.x,-this.y)/Math.PI},t.prototype.addDirection=function(t,e){var r=t*Math.PI/180;return this.x+=Math.sin(r)*e,this.y-=Math.cos(r)*e,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.normalize=function(){return this.divide(this.length())},t.prototype.divide=function(t){return this.x/=t,this.y/=t,this},t.prototype.multiply=function(t){return this.x*=t,this.y*=t,this},t.prototype.rotate=function(t){if(0==t)return this;var e=t*Math.PI/180,r=this.x;return this.x=this.x*Math.cos(e)-this.y*Math.sin(e),this.y=r*Math.sin(e)+this.y*Math.cos(e),this},t.prototype.copy=function(){return new t(this.x,this.y)},t.prototype.onScreen=function(){return this.x>=0&&this.x<=1&&this.y>=0&&this.y<=1},t.prototype.equal=function(t){return this.x==t.x&&this.y==t.y},t}();e.Vector=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,r){this.r=t,this.g=e,this.b=r}return Object.defineProperty(t,"black",{get:function(){return t.hexToRgb(t.currentPalette.black)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"white",{get:function(){return t.hexToRgb(t.currentPalette.white)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"grey",{get:function(){return t.hexToRgb(t.currentPalette.grey)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"darkgrey",{get:function(){return t.hexToRgb(t.currentPalette.darkgrey)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"lightgrey",{get:function(){return t.hexToRgb(t.currentPalette.lightgrey)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gray",{get:function(){return t.hexToRgb(t.currentPalette.grey)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"darkgray",{get:function(){return t.hexToRgb(t.currentPalette.darkgrey)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"lightgray",{get:function(){return t.hexToRgb(t.currentPalette.lightgrey)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"red",{get:function(){return t.hexToRgb(t.currentPalette.red)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"darkred",{get:function(){return t.hexToRgb(t.currentPalette.darkred)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"lightred",{get:function(){return t.hexToRgb(t.currentPalette.lightred)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"brown",{get:function(){return t.hexToRgb(t.currentPalette.brown)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"darkbrown",{get:function(){return t.hexToRgb(t.currentPalette.darkbrown)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"lightbrown",{get:function(){return t.hexToRgb(t.currentPalette.lightbrown)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"green",{get:function(){return t.hexToRgb(t.currentPalette.green)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"darkgreen",{get:function(){return t.hexToRgb(t.currentPalette.darkgreen)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"lightgreen",{get:function(){return t.hexToRgb(t.currentPalette.lightgreen)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"blue",{get:function(){return t.hexToRgb(t.currentPalette.blue)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"darkblue",{get:function(){return t.hexToRgb(t.currentPalette.darkblue)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"lightblue",{get:function(){return t.hexToRgb(t.currentPalette.lightblue)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"orange",{get:function(){return t.hexToRgb(t.currentPalette.orange)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"yellow",{get:function(){return t.hexToRgb(t.currentPalette.yellow)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"purple",{get:function(){return t.hexToRgb(t.currentPalette.purple)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pink",{get:function(){return t.hexToRgb(t.currentPalette.pink)},enumerable:!0,configurable:!0}),t.hexToRgb=function(e){var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?new t(parseInt(r[1],16)/255,parseInt(r[2],16)/255,parseInt(r[3],16)/255):null},t.prototype.toString=function(){return"rgb("+255*this.r+", "+255*this.g+", "+255*this.b+")"},t.arnecolors={black:"#000000",white:"#FFFFFF",grey:"#9d9d9d",darkgrey:"#697175",lightgrey:"#cccccc",gray:"#9d9d9d",darkgray:"#697175",lightgray:"#cccccc",red:"#be2633",darkred:"#732930",lightred:"#e06f8b",brown:"#a46422",darkbrown:"#493c2b",lightbrown:"#eeb62f",orange:"#eb8931",yellow:"#f7e26b",green:"#44891a",darkgreen:"#2f484e",lightgreen:"#a3ce27",blue:"#1d57f7",lightblue:"#B2DCEF",darkblue:"#1B2632",purple:"#342a97",pink:"#de65e2"},t.currentPalette=t.arnecolors,t}();e.Color=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(1),o=r(3),a=r(6),s=r(4),u=r(8),c=r(0),h=r(9),l=r(10),f=r(11);r(12);var p=function(){function t(e){void 0===e&&(e=new o.Display);var r=this;if(this.currentTime=0,this.previousTime=0,this.delta=0,this.score=0,this.leaderboardEnabled=!1,this.lastScore=-1,this.highScore=-1,this._ticks=0,this.saveSupported=!1,this.fibers=[],this.leaderboardText=new a.TextActor(""),this.rankStrings=["ST","ND","RD"],this.currentState="title",window.cancelAnimationFrame(t.animationFrameIdentifier),a.Actor.clear(),"changeMe"!=s.Config.saveName?this.saveSupported=!0:console.warn("Change Config.saveName to add support for score saving"),this.saveSupported)try{window.localStorage.getItem(s.Config.saveName)&&(this.highScore=Number(window.localStorage.getItem(s.Config.saveName)))}catch(t){this.saveSupported=!1,console.log(t)}t._INTERVAL=1e3/s.Config.fps,n=t._INTERVAL,t.display=e,o.Display.element.focus(),h.Keyboard.initialize(),u.Mouse.initialize(),this.transitionToTitle(),t.animationFrameIdentifier=t.requestAnimationFrame(function(t){r.updateFrame(t)})}return Object.defineProperty(t,"INTERVAL",{get:function(){return t._INTERVAL},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ticks",{get:function(){return this._ticks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gameOver",{get:function(){return"game"!=this.currentState},enumerable:!0,configurable:!0}),t.runOnReady=function(t){"complete"==document.readyState?t():window.addEventListener("load",function(){t()},!0)},t.prototype.endGame=function(){if(u.Mouse.pressedThisFrame=!1,this.lastScore=this.score,this.lastScore>0&&this.lastScore>this.highScore&&(this.highScore=this.lastScore,this.saveSupported))try{window.localStorage.setItem(s.Config.saveName,this.highScore.toString())}catch(t){console.log("failed to write local storage")}this.transitionToTitle(),this.currentState="title",this.onEndGame(),this.fibers=[]},t.prototype.newFiber=function(){var t=new f.Fiber;return this.fibers.push(t),t},t.prototype.onBeginGame=function(){},t.prototype.onEndGame=function(){},t.prototype.update=function(){},t.prototype.updateTitle=function(){(h.Keyboard.keyDown[h.Keyboard.SPACE]||u.Mouse.pressedThisFrame)&&this.transitionToGame(),this.leaderboardEnabled&&this.updateLeaderboard()},t.prototype.updateLeaderboard=function(){var t=this,e=Math.floor(this.ticks/180)%4;if(this.ticks%180==0){switch(e){case 0:break;case 1:l.Leaderboard.get(!0);break;case 2:l.Leaderboard.get(!1,!0);break;case 3:l.Leaderboard.get()}l.Leaderboard.get()}if(null!=l.Leaderboard.scores&&0!=e){var r=0,n=.2;this.leaderboardText.color=i.Color.white;this.leaderboardText.displayString=["LAST","BEST","TOP"][e-1],this.leaderboardText.setPosition(new c.Vector(.5,n)),this.leaderboardText.update(),n+=.035,l.Leaderboard.scores.forEach(function(e){if(l.Leaderboard.playerId==e.playerId?(t.leaderboardText.color=i.Color.lightgreen,t.leaderboardText.xAlign=1,t.leaderboardText.setPosition(new c.Vector(.2,.03*r+n)),t.leaderboardText.displayString="YOU",t.leaderboardText.update()):t.leaderboardText.color=i.Color.white,t.leaderboardText.xAlign=1,t.leaderboardText.setPosition(new c.Vector(.4,.03*r+n)),null!=e.rank){var o=""+(e.rank+1)+(e.rank<3?t.rankStrings[e.rank]:"TH");t.leaderboardText.displayString=o,t.leaderboardText.update()}t.leaderboardText.xAlign=-1,t.leaderboardText.setPosition(new c.Vector(.6,.03*r+n)),t.leaderboardText.displayString=e.score.toString(),t.leaderboardText.update(),r++})}},t.prototype.transitionToTitle=function(){var t=1==s.Config.title.length?.2:.15;new a.TextActor(s.Config.title).setPosition(new c.Vector(.5,t)).setDurationForever().scale=new c.Vector(2,2),new a.TextActor("[ SPACE / TAP ] TO START").setPosition(new c.Vector(.5,.7)).setDurationForever(),this.lastScore>=0&&(new a.TextActor("LAST SCORE: "+this.lastScore).setPosition(new c.Vector(.5,.8)).setDurationForever(),l.Leaderboard.set(this.score)),this.highScore>=0&&(this.lastScore!=this.highScore?new a.TextActor("YOUR HIGH SCORE: "+this.highScore).setPosition(new c.Vector(.5,.85)).setDurationForever():new a.TextActor("NEW HIGH SCORE!!!").setPosition(new c.Vector(.5,.85)).setDurationForever())},t.prototype.enableLeaderboard=function(t){void 0===t&&(t=""),l.Leaderboard.init(t),this.leaderboardEnabled=!0},t.prototype.transitionToGame=function(){this.currentState="game",this.score=0,a.Actor.clear(),this.onBeginGame()},t.prototype.preUpdateFrame=function(e){var r=this;return this.currentTime=e||(new Date).getTime(),this.delta+=(this.currentTime-this.previousTime)/t._INTERVAL,this.previousTime=this.currentTime,this.delta>=.75||(t.animationFrameIdentifier=t.requestAnimationFrame(function(t){r.updateFrame(t)}),!1)},t.prototype.updateFrame=function(e){if(this.preUpdateFrame(e)){t.display.preUpdate(),u.Mouse.Update(),this._ticks++,this.update(),a.Actor.update();for(var r=0;!(r>=this.fibers.length);){var n=this.fibers[r];n.isDestroying?this.fibers.splice(r,1):(n.update(),r++)}"title"==this.currentState&&this.updateTitle(),t.display.drawText("SCORE: "+this.score,1,0,1),h.Keyboard.keyDown[67]&&t.display.beginCapture(s.Config.captureConfig.duration,s.Config.captureConfig.interval,s.Config.captureConfig.scale),t.display.isCapturing&&t.display.capture()&&t.display.endCapture(),this.postUpdateFrame()}},t.prototype.postUpdateFrame=function(){var e=this;this.delta=0,t.animationFrameIdentifier=t.requestAnimationFrame(function(t){e.updateFrame(t)})},t.requestAnimationFrame=function(t){return d(t)},t}();e.Game=p;var d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,n/2)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=r(0),o=r(4),a=r(7),s=r(2);r(15),r(16),r(17),r(18);var u=function(){function t(){this.textDrawer=new a.TextDrawer,this.captureIndex=0,this.captureDuration=0,this.captureInterval=.016,this._isCapturing=!1,this.buildDisplay(),this.setSize()}return Object.defineProperty(t.prototype,"isCapturing",{get:function(){return this._isCapturing},enumerable:!0,configurable:!0}),t.prototype.buildDisplay=function(){var e=this,r=document.getElementById("display");t.element=r,this.context=t.element.getContext("2d"),window.onresize=function(){e.resizeTimer&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(e.setSize,200)},this.setSize()},t.prototype.setSize=function(){var e=document.getElementById("displayDiv"),r=Math.min(e.clientWidth,e.clientHeight);t.element.width=t.element.height=r,t.size.set(r,r)},t.prototype.preUpdate=function(){this.clear()},t.prototype.clear=function(){this.context.fillStyle=o.Config.backgroundColor.toString(),this.context.fillRect(0,0,t.size.x,t.size.y)},t.prototype.fillRect=function(e,r,i,o,a){void 0===a&&(a=n.Color.white),this.fillRectDirect((e-i/2)*t.size.x,(r-o/2)*t.size.y,i*t.size.x,o*t.size.y,a)},t.prototype.fillRectDirect=function(t,e,r,i,o){void 0===o&&(o=n.Color.white),this.context.fillStyle=o?o.toString():n.Color.white.toString(),this.context.fillRect(t,e,r,i)},t.prototype.drawText=function(e,r,i,o,a,s,u){void 0===o&&(o=-1),void 0===a&&(a=-1),void 0===s&&(s=n.Color.white),void 0===u&&(u=1),this.textDrawer.setSize(t.size),this.textDrawer.drawString(e,r,i,o,a,s,u)},t.prototype.beginCapture=function(e,r,n){void 0===e&&(e=1),void 0===r&&(r=.016),void 0===n&&(n=.65),this.captureDuration=Math.floor(e/r),this.captureInterval=Math.floor(1e3*r);Math.floor(s.Game.INTERVAL*r);this.captureContexts=[],this.captureIndex=0;for(var i=0;i<this.captureDuration;i++){var o=document.createElement("canvas");o.width=t.size.x*n,o.height=t.size.y*n;var a=o.getContext("2d");a.scale(n,n),this.captureContexts.push(a)}this._isCapturing=!0},t.prototype.capture=function(){return this.captureContexts[this.captureIndex].drawImage(t.element,0,0),this.captureIndex++,this.captureIndex>=this.captureDuration},t.prototype.endCapture=function(){this._isCapturing=!1;var t=new GIFEncoder;t.setRepeat(0),t.setDelay(this.captureInterval),t.start();for(var e=0;e<this.captureDuration;e++)t.addFrame(this.captureContexts[e])||console.log("adding frame failed");t.finish();var r=t.stream().getData();return window.location.href="data:image/gif;base64,"+encode64(r)},t.element=null,t.size=new i.Vector(0,0),t}();e.Display=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=function(){return function(t,e,r){void 0===t&&(t=.5),void 0===e&&(e=3),void 0===r&&(r=.05),this.scale=t,this.duration=e,this.interval=r}}();e.CaptureConfig=i;var o=function(){function t(){}return t.fps=60,t.backgroundColor=n.Color.black,t.soundTempo=120,t.soundVolume=.02,t.debugMode=!0,t.title="GAME TITLE",t.saveName="changeMe",t.isDebuggingMode=!1,t.captureConfig=new i,t}();e.Config=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){void 0===t&&(t=-2147483647),this.seed(t)}return t.prototype.seed=function(t){return void 0===t&&(t=-2147483647),-2147483647==t&&(t=Math.floor(2147483647*Math.random())),this.sv=t,this.x=t=1812433253*(t^t>>30),this.y=t=1812433253*(t^t>>30)+1,this.z=t=1812433253*(t^t>>30)+2,this.w=t=1812433253*(t^t>>30)+3,this},t.range=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.instance.range(t,e)},t.rangeInt=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.instance.rangeInt(t,e)},t.value=function(){return this.instance.value()},t.prototype.range=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.value()*(e-t)+t},t.prototype.rangeInt=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),Math.floor(this.range(t,e+1))},t.prototype.value=function(){var t=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>19^t^t>>8,this.w/2147483647},t.instance=new t,t}();e.Random=n},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(2),s=r(7),u=r(0),c=function(){function t(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.position=new u.Vector(0,0),this.velocity=new u.Vector(0,0),this.rotation=0,this.scale=new u.Vector(1,1),this.drawing=new s.Drawing,this.isDestroying=!1,this.age=0;for(var n,i=this.constructor.name,o=0;o<t.groups.length;o++){var a=t.groups[o];if(a.name==i){n=a;break}}n||(n=new l(i),t.groups.push(n),this.initialize()),n.members.push(this),this.group=n,this.begin.apply(this,e),this.drawing.position.set(this.position.x,this.position.y),this.drawing.updateState()}return t.prototype.initialize=function(){},t.prototype.destroy=function(){this.isDestroying=!0},t.prototype.begin=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.update=function(){},t.scroll=function(e,r){e.forEach(function(e){t.getGroup(e).forEach(function(t){t.position.add(r)})})},t.prototype.setPosition=function(t){return this.position.set(t.x,t.y),this.updateDrawing(),this},t.prototype.setVelocity=function(t){return this.velocity.set(t.x,t.y),this},t.prototype.lateUpdate=function(){this.position.add(this.velocity),this.updateDrawing(),this.drawing.draw(),this.age++},t.prototype.updateDrawing=function(){this.drawing.rotation=this.rotation,this.drawing.position.set(this.position.x,this.position.y),this.drawing.scale.set(this.scale.x,this.scale.y)},t.prototype.checkOverlap=function(e,r){var n=this,i=!1;return t.getGroup(e).forEach(function(t){t.drawing.isOverlapping(n.drawing)&&(i=!0,r&&r(t))}),i},t.update=function(){t.totalCount=0,t.groups.forEach(function(e){t.totalCount+=e.members.length,e.update()})},t.clear=function(){t.groups.forEach(function(t){t.clear()})},t.getGroup=function(e){for(var r=e.name,n=0;n<t.groups.length;n++){var i=t.groups[n];if(i.name==r)return i.members}return[]},t.prototype.setDisplayPriority=function(e){this.group.displayPriority=e,t.sortGroups()},t.sortGroups=function(){t.groups.sort(function(t,e){return t.displayPriority-e.displayPriority})},t.groups=[],t.totalCount=0,t}();e.Actor=c;var h=function(t){function e(e){var r=t.call(this)||this;return r.displayString="",r.displayString=e,r}return i(e,t),e.prototype.begin=function(){this.setDisplayPriority(2),this.duration=1,this.scale.set(1,1),this.xAlign=0,this.color=o.Color.white},e.prototype.setDurationForever=function(){return this.duration=999999,this},e.prototype.update=function(){a.Game.display.drawText(this.displayString,this.position.x,this.position.y,0,this.xAlign,this.color,this.scale.x),this.position.add(this.velocity),this.age>this.duration&&this.destroy()},e.prototype.setDuration=function(t){return this.duration=t,this},e.prototype.setVelocity=function(e){return t.prototype.setVelocity.call(this,e),this},e.prototype.setPosition=function(e){return t.prototype.setPosition.call(this,e),this},e}(c);e.TextActor=h;var l=function(){function t(t){this.displayPriority=1,this.name=t,this.clear()}return t.prototype.clear=function(){this.members=[]},t.prototype.update=function(){for(var t=0;!(t>=this.members.length);){var e=this.members[t];e.isDestroying?this.members.splice(t,1):(e.update(),e.lateUpdate(),t++)}},t}();e.ActorGroup=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),i=r(0),o=r(3),a=function(){function t(){this.dotPatterns=[],this.charToIndex=[],this.baseDotSize=1;for(var e=0,r=32,n=0,o=1;o<=t.COUNT;o++){for(var a=[],s=1;s<=5;s++)for(var u=1;u<=4;u++)++r>=32&&(e=t.patterns[n++],r=0),(1&e)>0&&a.push(new i.Vector(u,s)),e>>=1;this.dotPatterns.push(a)}for(var c=0;c<=127;c++){var h=void 0;if(32==c)h=-1;else if(48<=c&&c<58)h=c-48;else if(65<=c&&c<90)h=c-65+10;else{var l="()[]<>=+-*/%&_!?,.:|'\"$@#\\urdl".indexOf(String.fromCharCode(c));h=l>=0?l+36:-2}this.charToIndex.push(h)}}return t.prototype.drawString=function(t,e,r,n,i,a,s){var u=Math.floor(e*o.Display.size.x),c=Math.floor(r*o.Display.size.y),h=this.baseDotSize*s,l=5*h;0==n?u-=Math.floor(t.length*l/2):1==n&&(u-=Math.floor(t.length*l)),0==i&&(c-=Math.floor(3.5*h));for(var f=0;f<t.length;f++){var p=t[f],d=this.charToIndex[p.charCodeAt(0)];if(d>=0)this.drawDots(d,u,c,a,h);else if(-2==d)throw"invalid char: "+p;u+=l}},t.prototype.drawDots=function(t,e,r,i,o){for(var a=0;a<this.dotPatterns[t].length;a++){var s=this.dotPatterns[t][a];n.Game.display.fillRectDirect(e+s.x*o,r+s.y*o,o,o,i)}},t.prototype.setSize=function(t){this.baseDotSize=Math.floor(Math.min(t.x,t.y)/250+1).clamp(1,20)},t.COUNT=66,t.patterns=[1178905252,1864668900,4116998473,376992244,613021335,3915814550,2046400104,2442557817,528062838,292683543,4187935126,3997453977,1398351172,4193325337,2648414617,2037815702,2128188945,2250152313,2571388135,1181324953,1771503001,4098267545,572846664,639910948,1682204194,2217230920,1089531940,251675876,1208634944,2588250404,678422,1678001392,2147500105,1077936132,1145323584,178257988,1685513216,4210713049,3830337194,619979845,4064601412,66],t}();e.TextDrawer=a;var s=function(){function t(t,e,r,n,o,a){this.color=t,this.width=e,this.height=r,this.offsetX=n,this.offsetY=o,this.hasCollision=a,this.currentPosition=new i.Vector(0,0),this.currentSize=new i.Vector(0,0)}return t.prototype.updateState=function(t){this.currentPosition.set(this.offsetX*t.scale.x,this.offsetY*t.scale.y),this.currentPosition.rotate(t.rotation),this.currentPosition.add(t.position),this.currentSize.set(this.width*t.scale.x,this.height*t.scale.y)},t.prototype.draw=function(t){this.updateState(t),n.Game.display.fillRect(this.currentPosition.x,this.currentPosition.y,this.currentSize.x,this.currentSize.y,this.color)},t.prototype.isOverlapping=function(t){return!(!this.hasCollision||!t.hasCollision)&&(Math.abs(this.currentPosition.x-t.currentPosition.x)<(this.currentSize.x+t.currentSize.x)/2&&Math.abs(this.currentPosition.y-t.currentPosition.y)<(this.currentSize.y+t.currentSize.y)/2)},t}();e.DrawingRect=s;var u=function(){function t(){this.position=new i.Vector(0,0),this.rotation=0,this.scale=new i.Vector(1,1),this.rects=[],this.hasCollision=!0}return t.prototype.setColor=function(t){return this.color=t,this},t.prototype.addRect=function(e,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0),this.rects.push(new s(this.color,e,0==r?e:r,n,i,this.hasCollision)),this.lastAdded=new t.RectParam("rect",e,0==r?e:r,n,i),this},t.prototype.addSegementedRect=function(e,r,n,i,o){void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),this.lastAdded=new t.RectParam("segmentedRect",e,0==r?e:r,n,i,o);var a=o*Math.PI/180;if(e>r){a+=Math.PI/2;var u=e;e=r,r=u}if(e<.01)return this;var c=Math.floor(r/e),h=-e*(c-1)/2,l=e;e*=1.05;for(var f=0;f<c;f++)this.rects.push(new s(this.color,e,e,Math.sin(a)*h+n,Math.cos(a)*h+i,this.hasCollision)),h+=l;return this},t.prototype.addArc=function(t,e){void 0===e&&(e=1);for(var r=new i.Vector(this.lastAdded.offsetX,this.lastAdded.offsetY),n=this.lastAdded.angle,o=0;o<e;o++)r.rotate(t),"rect"==this.lastAdded.type?this.addRect(this.lastAdded.width,this.lastAdded.height,r.x,r.y):(n-=t,this.addSegementedRect(this.lastAdded.width,this.lastAdded.height,r.x,r.y,n));return this},t.prototype.mirrorX=function(){return"rect"==this.lastAdded.type&&this.addRect(this.lastAdded.width,this.lastAdded.height,-this.lastAdded.offsetX,this.lastAdded.offsetY),this},t.prototype.mirrorY=function(){return"rect"==this.lastAdded.type&&this.addRect(this.lastAdded.width,this.lastAdded.height,this.lastAdded.offsetX,-this.lastAdded.offsetY),this},t.prototype.updateState=function(){var t=this;this.rects.forEach(function(e){e.updateState(t)})},t.prototype.setPosition=function(t){return this.position.set(t),this},t.prototype.setRotation=function(t){return this.rotation=t,this},t.prototype.draw=function(){var t=this;this.rects.forEach(function(e){e.draw(t)})},t.prototype.isOverlapping=function(t){this.updateState();for(var e=0;e<this.rects.length;e++)for(var r=this.rects[e],n=0;n<t.rects.length;n++){var i=t.rects[n];if(r.isOverlapping(i))return!0}return!1},t.RectParam=function(){return function(t,e,r,n,i,o){void 0===o&&(o=0),this.type=t,this.width=e,this.height=r,this.offsetX=n,this.offsetY=i,this.angle=o}}(),t}();e.Drawing=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=r(3),o=function(){function t(){}return t.initialize=function(){t.position=new n.Vector(.5,.5),i.Display.element.addEventListener("mousedown",t.onMouseDown),i.Display.element.addEventListener("mouseup",t.onMouseUp),i.Display.element.addEventListener("mousemove",t.onMouseMove),i.Display.element.addEventListener("touchstart",this.onTouchStart),i.Display.element.addEventListener("touchmove",this.onTouchMove),i.Display.element.addEventListener("touchend",this.onTouchEnd)},t.onMouseUp=function(e){t.isPressed=!1},t.onMouseDown=function(e){i.Display.element.focus(),console.log("focusing?",document.activeElement,i.Display.element),t.isPressed=!0,t.onMouseMove(e)},t.onMouseMove=function(e){e.preventDefault();var r=e.target.getBoundingClientRect();t.position.x=(e.pageX-r.left)/i.Display.size.x,t.position.y=(e.pageY-r.top)/i.Display.size.y},t.onTouchMove=function(e){e.preventDefault();var r=e.target.getBoundingClientRect(),n=e.touches[0];t.position.x=((n.pageX-r.left)/i.Display.size.x).clamp(0,1),t.position.y=((n.pageY-r.top)/i.Display.size.y).clamp(0,1)},t.onTouchStart=function(e){t.isPressed=!0,t.onTouchMove(e)},t.onTouchEnd=function(e){t.isPressed=!1},t.Update=function(){t.pressedThisFrame=t.isPressed&&!t.wasPressed,t.wasPressed=t.isPressed},t.pressedThisFrame=!1,t.wasPressed=!1,t}();e.Mouse=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(3),i=function(){function t(){}return t.initialize=function(){t.keyDown=[];for(var e=0;e<255;e++)t.keyDown[e]=!1,n.Display.element.onkeydown=function(e){t.keyDown[e.keyCode]=!0,67==e.keyCode&&e.preventDefault(),e.keyCode>=37&&e.keyCode<=40&&e.preventDefault(),32==e.keyCode&&e.preventDefault()},n.Display.element.onkeyup=function(e){t.keyDown[e.keyCode]=!1}},t.LEFT=37,t.UP=38,t.RIGHT=39,t.DOWN=40,t.SPACE=32,t}();e.Keyboard=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(19),i=function(){function t(){}return t.init=function(e){t.urlRoot=e;var r=localStorage.getItem(t.playerIdKey);null==r?window.fetch(t.urlRoot+"/api/nextPlayerId").then(function(t){return t.json()}).then(function(e){t.playerId=e.id,localStorage.setItem(t.playerIdKey,String(t.playerId))}):t.playerId=Number(r)},t.get=function(e,r){if(void 0===e&&(e=!1),void 0===r&&(r=!1),null!=t.playerId){var n=t.urlRoot+"/api/score";e?n+="?score="+t.lastScore+"&count=9":r&&(n+="?playerId="+t.playerId),window.fetch(n).then(function(t){return t.json()}).then(function(r){t.scores=r,e&&(t.scores.push({score:t.lastScore,playerId:t.playerId}),t.scores=t.scores.sort(function(t,e){return t.score<e.score?-1:t.score>e.score?1:0}))})}else t.scores=null},t.set=function(e){t.lastScore=e,window.fetch(t.urlRoot+"/api/key?playerId="+t.playerId).then(function(t){return t.json()}).then(function(r){var i=r.key,o=new Headers;o.append("Content-Type","application/json");var a=n.compressToEncodedURIComponent(JSON.stringify({key:i,score:{playerId:t.playerId,score:e}}));window.fetch(t.urlRoot+"/api/score",{method:"POST",headers:o,body:JSON.stringify({data:a})})})},t.playerIdKey="worm-drive",t.lastScore=0,t.urlRoot="",t}();e.Leaderboard=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.ops=[],this.waitCounter=0,this.current=0,this.isDestroying=!1}return t.prototype.do=function(t){return this.ops.push(t),this},t.prototype.wait=function(t){var e=this;return this.ops.push(function(){e.waitCounter=t}),this},t.prototype.update=function(){0!=this.ops.length&&(this.waitCounter>0?this.waitCounter--:(this.ops[this.current](),this.current=(this.current+1)%this.ops.length))},t}();e.Fiber=n},function(t,e){Number.prototype.clamp=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this<t?t:this>e?e:this},Number.prototype.loopRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);var r=e-t,n=this;return(n-=t)>=0?n%r+t:r+n%r+t},Number.prototype.mod=function(t){return(this%t+t)%t}},function(t,e,r){var n,i;n=this,i=function(){"use strict";var t={},e=r(22);return function(){this.Parameters=[],this.Generators={square:e.generators.square,saw:e.generators.saw,triangle:e.generators.triangle,sine:e.generators.sine,noise:e.generators.noise,synth:e.generators.synth},this.getGeneratorNames=function(){var t=[];for(var e in this.Generators)t.push(e);return t};var r=function(t){return t.replace(/ /g,"")};this.getParameters=function(){var t,e,n,i,o=[],a=0,s=function(t,e,n,i,s){void 0===s&&(s=(n-e)/1e3);var u={name:t,id:r(t),min:e,max:n,step:s,def:i,type:"range",group:a};o.push(u)},u=this.getGeneratorNames();return t="Generator",e=u,n=u[0],i={name:t,id:r(t),options:e,def:n,type:"option",group:a},o.push(i),s("Super Sampling Quality",0,16,0,1),s("Master Volume",0,1,.4),a++,s("Attack Time",0,1,.1),s("Sustain Time",0,2,.3),s("Sustain Punch",0,3,2),s("Decay Time",0,2,1),a++,s("Min Frequency",20,2400,0,1),s("Start Frequency",20,2400,440,1),s("Max Frequency",20,2400,2e3,1),s("Slide",-1,1,0),s("Delta Slide",-1,1,0),a++,s("Vibrato Depth",0,1,0),s("Vibrato Frequency",.01,48,8),s("Vibrato Depth Slide",-.3,1,0),s("Vibrato Frequency Slide",-1,1,0),a++,s("Change Amount",-1,1,0),s("Change Speed",0,1,.1),a++,s("Square Duty",0,.5,0),s("Square Duty Sweep",-1,1,0),a++,s("Repeat Speed",0,.8,0),a++,s("Phaser Offset",-1,1,0),s("Phaser Sweep",-1,1,0),a++,s("LP Filter Cutoff",0,1,1),s("LP Filter Cutoff Sweep",-1,1,0),s("LP Filter Resonance",0,1,0),s("HP Filter Cutoff",0,1,0),s("HP Filter Cutoff Sweep",-1,1,0),o},this.generate=function(r){var n=2*Math.PI,i=Math.sin,o=(Math.cos,Math.pow),a=Math.abs,s=e.SampleRate,u=0|r.SuperSamplingQuality;u<1&&(u=1),s*=u;for(var c=1+r.SustainPunch,h=[{from:0,to:1,time:r.AttackTime},{from:c,to:1,time:r.SustainTime},{from:1,to:0,time:r.DecayTime}],l=h.length,f=0;f<l;f++)h[f].samples=1+(h[f].time*s|0);var p=void 0,d=0,y=-1,g=0,v=-1,m=0;for(f=0;f<l;f++)m+=h[f].samples;m<s/2&&(m=s/2);var b=new Array(m/u|0),w=0,x=0,P=t.Generators[r.Generator];void 0===P&&(P=this.Generators.square);var S=0;S=r.SquareDuty;var T=r.SquareDutySweep/s,C=0,A=r.StartFrequency*n/s,M=1+64*o(r.Slide,3)/s,D=o(r.DeltaSlide,3)/(1e3*s);void 0!==u&&(D/=u),r.MinFrequency>r.StartFrequency&&(r.MinFrequency=r.StartFrequency),r.MaxFrequency<r.StartFrequency&&(r.MaxFrequency=r.StartFrequency);var F=r.MinFrequency*n/s,R=r.MaxFrequency*n/s,I=0,O=r.VibratoFrequency*n/s,j=r.VibratoDepth,_=1+3*o(r.VibratoFrequencySlide,3)/s,k=r.VibratoDepthSlide/s,E=0,z=r.ChangeSpeed*s,B=o(r.ChangeAmount,2);B=r.ChangeAmount>0?1+10*B:1-.9*B;for(var V=new Array(1024),L=0;L<1024;L++)V[L]=0;var N=0,q=1020*o(r.PhaserOffset,2),G=4e3*o(r.PhaserSweep,3)/s,U=a(G)>1e-5||a(q)>1e-5,W=r.HPFilterCutoff>.001||r.LPFilterCutoff<.999,H=0,Y=0,K=o(r.LPFilterCutoff,3)/10,X=1+r.HPFilterCutoffSweep/1e4,Q=5/(1+20*o(r.LPFilterResonance,2))*(.01+r.LPFilterCutoff);Q>.8&&(Q=.8),Q=1-Q;var Z=r.LPFilterCutoff<.999,J=0,$=o(r.HPFilterCutoff,2)/10,tt=1+r.HPFilterCutoffSweep/1e4,et=0,rt=m;r.RepeatSpeed>0&&(rt=o(1-r.RepeatSpeed,2)*s+32);var nt=r.MasterVolume,it=0;for(f=0;f<m;f++){if(w=P(C,S,0),(S+=T)<0?S=0:S>.5&&(S=.5),et>rt&&(C=0,A=r.StartFrequency*n/s,M=1+3*o(r.Slide,3)/s,D=o(r.DeltaSlide,3)/(1e3*s),void 0!==u&&(D/=u),E=0,z=r.ChangeSpeed*s,B=1+(0|r.ChangeAmount)/12,et=0),et+=1,C+=A,A*=M+=D,E>z&&(A*=B,z=m),E+=1,A>R?A=R:A<F&&(A=F),C+=A*i(I+=O)*j,O*=_,k&&((j+=k)<0?(j=0,k=0):j>1&&(j=1,k=0)),W){a($)>.001&&(($*=tt)<1e-5?$=1e-5:$>.1&&($=.1));var ot=H;(K*=X)<0?K=0:K>.1&&(K=.1),Z?(Y+=(w-H)*K,Y*=Q):(H=w,Y=0),J+=(H+=Y)-ot,w=J*=1-$}if(U)(q+=G)<0&&(q=-q,G=-G),q>1023&&(q=1023,G=0),V[N]=w,w+=V[N-(0|q)+1024&1023],N=N+1&1023;f>v&&(d=(p=(y+=1)<l?h[y]:{from:0,to:0,samples:m}).from,g=(p.to-p.from)/(p.samples+1),v+=p.samples),w*=d,d+=g,w*=nt,u>1?(x+=w,(f+1)%u==0&&(b[it]=x/u,it+=1,x=0)):b[f]=w}var at=s/100|0,st=new Array(at);for(f=0;f<at;f++)st[f]=0;return st.concat(b).concat(st)},this.Parameters=this.getParameters()}.apply(t),t},"object"==typeof t.exports?t.exports=i():n.jsfx=i()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0);e.Vector=n.Vector;var i=r(5);e.Random=i.Random;var o=r(6);e.Actor=o.Actor,e.TextActor=o.TextActor;var a=r(1);e.Color=a.Color;var s=r(3);e.Display=s.Display;var u=r(4);e.Config=u.Config,e.CaptureConfig=u.CaptureConfig;var c=r(8);e.Mouse=c.Mouse;var h=r(20);e.ParticleSystem=h.ParticleSystem;var l=r(9);e.Keyboard=l.Keyboard;var f=r(7);e.Drawing=f.Drawing,e.TextDrawer=f.TextDrawer;var p=r(10);e.Leaderboard=p.Leaderboard;var d=r(2);e.Game=d.Game;var y=r(21);e.Sound=y.Sound;var g=r(11);e.Fiber=g.Fiber,r(12)},function(t,e){GIFEncoder=function(){for(var t=0,e={};t<256;t++)e[t]=String.fromCharCode(t);function r(){this.bin=[]}r.prototype.getData=function(){for(var t="",r=this.bin.length,n=0;n<r;n++)t+=e[this.bin[n]];return t},r.prototype.writeByte=function(t){this.bin.push(t)},r.prototype.writeUTFBytes=function(t){for(var e=t.length,r=0;r<e;r++)this.writeByte(t.charCodeAt(r))},r.prototype.writeBytes=function(t,e,r){for(var n=r||t.length,i=e||0;i<n;i++)this.writeByte(t[i])};var n,i,o,a,s,u,c,h,l,f={},p=null,d=-1,y=0,g=!1,v=[],m=7,b=-1,w=!1,x=!0,P=!1,S=10,T="Generated by jsgif (https://github.com/antimatter15/jsgif/)",C=(f.setDelay=function(t){y=Math.round(t/10)},f.setDispose=function(t){t>=0&&(b=t)},f.setRepeat=function(t){t>=0&&(d=t)},f.setTransparent=function(t){p=t},f.setComment=function(t){T=t},f.addFrame=function(t,e){if(null===t||!g||null===a)throw new Error("Please call start method before calling addFrame");var r=!0;try{e?t instanceof ImageData?(s=t.data,sizeset&&n==t.width&&i==t.height||A(t.width,t.height)):t instanceof Uint8ClampedArray?t.length==n*i*4?s=t:(console.log("Please set the correct size: ImageData length mismatch"),r=!1):(console.log("Please provide correct input"),r=!1):(s=t.getImageData(0,0,t.canvas.width,t.canvas.height).data,P||A(t.canvas.width,t.canvas.height)),F(),M(),x&&(j(),k(),d>=0&&_()),R(),""!==T&&I(),O(),x||k(),z(),x=!1}catch(t){console.log(t),r=!1}return r},f.download=function(t){if(null===a||0==w)console.log("Please call start method and add frames and call finish method before calling download");else{t=void 0!==t?t.endsWith(".gif")?t:t+".gif":"download.gif";var e=document.createElement("a");e.download=t,e.href=URL.createObjectURL(new Blob([new Uint8Array(a.bin)],{type:"image/gif"})),e.click()}},f.finish=function(){if(!g)return!1;var t=!0;g=!1;try{a.writeByte(59),w=!0}catch(e){t=!1}return t},function(){o=0,s=null,u=null,c=null,l=null,w=!1,x=!0}),A=(f.setFrameRate=function(t){15!=t&&(y=Math.round(100/t))},f.setQuality=function(t){t<1&&(t=1),S=t},f.setSize=function(t,e){g&&!x||((n=t)<1&&(n=320),(i=e)<1&&(i=240),P=!0)}),M=(f.start=function(){C();var t=!0;w=!1,a=new r;try{a.writeUTFBytes("GIF89a")}catch(e){t=!1}return g=t},f.cont=function(){C();return w=!1,a=new r,g=!0},function(){var t=u.length,e=t/3;c=[];var r=new NeuQuant(u,t,S);l=r.process();for(var n=0,i=0;i<e;i++){var a=r.map(255&u[n++],255&u[n++],255&u[n++]);v[a]=!0,c[i]=a}u=null,h=8,m=7,null!==p&&(o=D(p))}),D=function(t){if(null===l)return-1;for(var e=(16711680&t)>>16,r=(65280&t)>>8,n=255&t,i=0,o=16777216,a=l.length,s=0;s<a;){var u=e-(255&l[s++]),c=r-(255&l[s++]),h=n-(255&l[s]),f=u*u+c*c+h*h,p=s/3;v[p]&&f<o&&(o=f,i=p),s++}return i},F=function(){var t=n,e=i;u=[];for(var r=s,o=0,a=0;a<e;a++)for(var c=0;c<t;c++){var h=a*t*4+4*c;u[o++]=r[h],u[o++]=r[h+1],u[o++]=r[h+2]}},R=function(){var t,e;a.writeByte(33),a.writeByte(249),a.writeByte(4),null===p?(t=0,e=0):(t=1,e=2),b>=0&&(e=7&b),e<<=2,a.writeByte(0|e|t),E(y),a.writeByte(o),a.writeByte(0)},I=function(){a.writeByte(33),a.writeByte(254),a.writeByte(T.length),a.writeUTFBytes(T),a.writeByte(0)},O=function(){a.writeByte(44),E(0),E(0),E(n),E(i),x?a.writeByte(0):a.writeByte(128|m)},j=function(){E(n),E(i),a.writeByte(240|m),a.writeByte(0),a.writeByte(0)},_=function(){a.writeByte(33),a.writeByte(255),a.writeByte(11),a.writeUTFBytes("NETSCAPE2.0"),a.writeByte(3),a.writeByte(1),E(d),a.writeByte(0)},k=function(){a.writeBytes(l);for(var t=768-l.length,e=0;e<t;e++)a.writeByte(0)},E=function(t){a.writeByte(255&t),a.writeByte(t>>8&255)},z=function(){new LZWEncoder(n,i,c,h).encode(a)};f.stream=function(){return a},f.setProperties=function(t,e){g=t,x=e};return f}},function(t,e){NeuQuant=function(){var t,e,r,n,i,o={},a=[],s=[],u=[],c=[],h=o.NeuQuant=function(t,o,a){var c,h;for(e=t,r=o,n=a,i=new Array(256),c=0;c<256;c++)i[c]=new Array(4),(h=i[c])[0]=h[1]=h[2]=(c<<12)/256,u[c]=256,s[c]=0},l=(o.map=function(t,e,r){var n,o,s,u,c,h,l;for(c=1e3,l=-1,o=(n=a[e])-1;n<256||o>=0;)n<256&&((s=(h=i[n])[1]-e)>=c?n=256:(n++,s<0&&(s=-s),(u=h[0]-t)<0&&(u=-u),(s+=u)<c&&((u=h[2]-r)<0&&(u=-u),(s+=u)<c&&(c=s,l=h[3])))),o>=0&&((s=e-(h=i[o])[1])>=c?o=-1:(o--,s<0&&(s=-s),(u=h[0]-t)<0&&(u=-u),(s+=u)<c&&((u=h[2]-r)<0&&(u=-u),(s+=u)<c&&(c=s,l=h[3]))));return l},o.process=function(){return function(){var i,o,a,s,u,h,l,y,g,v,m,b,w,x;for(r<1509&&(n=1),t=30+(n-1)/3,b=e,w=0,x=r,v=(m=r/(3*n))/100|0,y=1024,(l=(h=2048)>>6)<=1&&(l=0),i=0;i<l;i++)c[i]=y*(256*(l*l-i*i)/(l*l));for(g=r<1509?3:r%499!=0?1497:r%491!=0?1473:r%487!=0?1461:1509,i=0;i<m;)if(a=(255&b[w+0])<<4,s=(255&b[w+1])<<4,u=(255&b[w+2])<<4,o=d(a,s,u),p(y,o,a,s,u),0!==l&&f(l,o,a,s,u),(w+=g)>=x&&(w-=r),0===v&&(v=1),++i%v==0)for(y-=y/t,(l=(h-=h/30)>>6)<=1&&(l=0),o=0;o<l;o++)c[o]=y*(256*(l*l-o*o)/(l*l))}(),l(),function(){var t,e,r,n,o,s,u,c;for(u=0,c=0,t=0;t<256;t++){for(r=t,n=(o=i[t])[1],e=t+1;e<256;e++)(s=i[e])[1]<n&&(r=e,n=s[1]);if(s=i[r],t!=r&&(e=s[0],s[0]=o[0],o[0]=e,e=s[1],s[1]=o[1],o[1]=e,e=s[2],s[2]=o[2],o[2]=e,e=s[3],s[3]=o[3],o[3]=e),n!=u){for(a[u]=c+t>>1,e=u+1;e<n;e++)a[e]=t;u=n,c=t}}for(a[u]=c+255>>1,e=u+1;e<256;e++)a[e]=255}(),function(){for(var t=[],e=new Array(256),r=0;r<256;r++)e[i[r][3]]=r;for(var n=0,o=0;o<256;o++){var a=e[o];t[n++]=i[a][0],t[n++]=i[a][1],t[n++]=i[a][2]}return t}()},function(){var t;for(t=0;t<256;t++)i[t][0]>>=4,i[t][1]>>=4,i[t][2]>>=4,i[t][3]=t}),f=function(t,e,r,n,o){var a,s,u,h,l,f,p;for((u=e-t)<-1&&(u=-1),(h=e+t)>256&&(h=256),a=e+1,s=e-1,f=1;a<h||s>u;){if(l=c[f++],a<h){p=i[a++];try{p[0]-=l*(p[0]-r)/(1<<18),p[1]-=l*(p[1]-n)/(1<<18),p[2]-=l*(p[2]-o)/(1<<18)}catch(t){}}if(s>u){p=i[s--];try{p[0]-=l*(p[0]-r)/(1<<18),p[1]-=l*(p[1]-n)/(1<<18),p[2]-=l*(p[2]-o)/(1<<18)}catch(t){}}}},p=function(t,e,r,n,o){var a=i[e];a[0]-=t*(a[0]-r)/1024,a[1]-=t*(a[1]-n)/1024,a[2]-=t*(a[2]-o)/1024},d=function(t,e,r){var n,o,a,c,h,l,f,p,d,y;for(d=p=~(1<<31),f=l=-1,n=0;n<256;n++)(o=(y=i[n])[0]-t)<0&&(o=-o),(a=y[1]-e)<0&&(a=-a),o+=a,(a=y[2]-r)<0&&(a=-a),(o+=a)<p&&(p=o,l=n),(c=o-(s[n]>>12))<d&&(d=c,f=n),h=u[n]>>10,u[n]-=h,s[n]+=h<<10;return u[l]+=64,s[l]-=65536,f};return h.apply(this,arguments),o}},function(t,e){LZWEncoder=function(){var t,e,r,n,i,o,a,s,u,c,h,l,f={},p=[],d=[],y=0,g=!1,v=0,m=0,b=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],w=[],x=f.LZWEncoder=function(i,o,a,s){t=i,e=o,r=a,n=Math.max(2,s)},P=function(t,e){w[l++]=t,l>=254&&A(e)},S=function(t){T(5003),y=c+2,g=!0,F(c,t)},T=function(t){for(var e=0;e<t;++e)p[e]=-1},C=f.compress=function(t,e){var r,n,i,o,f,v;for(g=!1,s=M(a=u=t),h=(c=1<<t-1)+1,y=c+2,l=0,o=D(),v=0,r=5003;r<65536;r*=2)++v;v=8-v,T(5003),F(c,e);t:for(;-1!=(i=D());)if(r=(i<<12)+o,p[n=i<<v^o]!=r){if(p[n]>=0){f=5003-n,0===n&&(f=1);do{if((n-=f)<0&&(n+=5003),p[n]==r){o=d[n];continue t}}while(p[n]>=0)}F(o,e),o=i,y<4096?(d[n]=y++,p[n]=r):S(e)}else o=d[n];F(o,e),F(h,e)},A=(f.encode=function(r){r.writeByte(n),i=t*e,o=0,C(n+1,r),r.writeByte(0)},function(t){l>0&&(t.writeByte(l),t.writeBytes(w,0,l),l=0)}),M=function(t){return(1<<t)-1},D=function(){return 0===i?-1:(--i,255&r[o++])},F=function(t,e){for(v&=b[m],m>0?v|=t<<m:v=t,m+=a;m>=8;)P(255&v,e),v>>=8,m-=8;if((y>s||g)&&(g?(s=M(a=u),g=!1):s=12==++a?4096:M(a)),t==h){for(;m>0;)P(255&v,e),v>>=8,m-=8;A(e)}};return x.apply(this,arguments),f}},function(t,e){encode64=function(t){for(var e,r,n,i,o,a,s,u="",c=0,h=t.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c<h;)i=(e=t.charCodeAt(c++))>>2,o=(3&e)<<4|(r=t.charCodeAt(c++))>>4,a=(15&r)<<2|(n=t.charCodeAt(c++))>>6,s=63&n,isNaN(r)?a=s=64:isNaN(n)&&(s=64),u=u+l.charAt(i)+l.charAt(o)+l.charAt(a)+l.charAt(s);return u}},function(t,e,r){var n,i=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function i(t,e){if(!n[t]){n[t]={};for(var r=0;r<t.length;r++)n[t][t.charAt(r)]=r}return n[t][e]}var o={compressToBase64:function(t){if(null==t)return"";var r=o._compress(t,6,function(t){return e.charAt(t)});switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:o._decompress(t.length,32,function(r){return i(e,t.charAt(r))})},compressToUTF16:function(e){return null==e?"":o._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:o._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(t){for(var e=o.compress(t),r=new Uint8Array(2*e.length),n=0,i=e.length;n<i;n++){var a=e.charCodeAt(n);r[2*n]=a>>>8,r[2*n+1]=a%256}return r},decompressFromUint8Array:function(e){if(null==e)return o.decompress(e);for(var r=new Array(e.length/2),n=0,i=r.length;n<i;n++)r[n]=256*e[2*n]+e[2*n+1];var a=[];return r.forEach(function(e){a.push(t(e))}),o.decompress(a.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":o._compress(t,6,function(t){return r.charAt(t)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),o._decompress(t.length,32,function(e){return i(r,t.charAt(e))}))},compress:function(e){return o._compress(e,16,function(e){return t(e)})},_compress:function(t,e,r){if(null==t)return"";var n,i,o,a={},s={},u="",c="",h="",l=2,f=3,p=2,d=[],y=0,g=0;for(o=0;o<t.length;o+=1)if(u=t.charAt(o),Object.prototype.hasOwnProperty.call(a,u)||(a[u]=f++,s[u]=!0),c=h+u,Object.prototype.hasOwnProperty.call(a,c))h=c;else{if(Object.prototype.hasOwnProperty.call(s,h)){if(h.charCodeAt(0)<256){for(n=0;n<p;n++)y<<=1,g==e-1?(g=0,d.push(r(y)),y=0):g++;for(i=h.charCodeAt(0),n=0;n<8;n++)y=y<<1|1&i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i>>=1}else{for(i=1,n=0;n<p;n++)y=y<<1|i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i=0;for(i=h.charCodeAt(0),n=0;n<16;n++)y=y<<1|1&i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i>>=1}0==--l&&(l=Math.pow(2,p),p++),delete s[h]}else for(i=a[h],n=0;n<p;n++)y=y<<1|1&i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i>>=1;0==--l&&(l=Math.pow(2,p),p++),a[c]=f++,h=String(u)}if(""!==h){if(Object.prototype.hasOwnProperty.call(s,h)){if(h.charCodeAt(0)<256){for(n=0;n<p;n++)y<<=1,g==e-1?(g=0,d.push(r(y)),y=0):g++;for(i=h.charCodeAt(0),n=0;n<8;n++)y=y<<1|1&i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i>>=1}else{for(i=1,n=0;n<p;n++)y=y<<1|i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i=0;for(i=h.charCodeAt(0),n=0;n<16;n++)y=y<<1|1&i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i>>=1}0==--l&&(l=Math.pow(2,p),p++),delete s[h]}else for(i=a[h],n=0;n<p;n++)y=y<<1|1&i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i>>=1;0==--l&&(l=Math.pow(2,p),p++)}for(i=2,n=0;n<p;n++)y=y<<1|1&i,g==e-1?(g=0,d.push(r(y)),y=0):g++,i>>=1;for(;;){if(y<<=1,g==e-1){d.push(r(y));break}g++}return d.join("")},decompress:function(t){return null==t?"":""==t?null:o._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,r,n){var i,o,a,s,u,c,h,l=[],f=4,p=4,d=3,y="",g=[],v={val:n(0),position:r,index:1};for(i=0;i<3;i+=1)l[i]=i;for(a=0,u=Math.pow(2,2),c=1;c!=u;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=r,v.val=n(v.index++)),a|=(s>0?1:0)*c,c<<=1;switch(a){case 0:for(a=0,u=Math.pow(2,8),c=1;c!=u;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=r,v.val=n(v.index++)),a|=(s>0?1:0)*c,c<<=1;h=t(a);break;case 1:for(a=0,u=Math.pow(2,16),c=1;c!=u;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=r,v.val=n(v.index++)),a|=(s>0?1:0)*c,c<<=1;h=t(a);break;case 2:return""}for(l[3]=h,o=h,g.push(h);;){if(v.index>e)return"";for(a=0,u=Math.pow(2,d),c=1;c!=u;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=r,v.val=n(v.index++)),a|=(s>0?1:0)*c,c<<=1;switch(h=a){case 0:for(a=0,u=Math.pow(2,8),c=1;c!=u;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=r,v.val=n(v.index++)),a|=(s>0?1:0)*c,c<<=1;l[p++]=t(a),h=p-1,f--;break;case 1:for(a=0,u=Math.pow(2,16),c=1;c!=u;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=r,v.val=n(v.index++)),a|=(s>0?1:0)*c,c<<=1;l[p++]=t(a),h=p-1,f--;break;case 2:return g.join("")}if(0==f&&(f=Math.pow(2,d),d++),l[h])y=l[h];else{if(h!==p)return null;y=o+o.charAt(0)}g.push(y),l[p++]=o+y.charAt(0),o=y,0==--f&&(f=Math.pow(2,d),d++)}}};return o}();void 0===(n=function(){return i}.call(e,r,e,t))||(t.exports=n)},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(2),a=r(1),s=r(6),u=r(0),c=r(5),h=function(){return function(){this.count=1,this.position=new u.Vector(0,0),this.angleWidth=360,this.speed=.01,this.color=a.Color.white,this.size=.02,this.duration=30,(new l).particleSystem=this}}();e.ParticleSystem=h;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.update=function(){if(this.particleSystem){this.destroy();var t=this.particleSystem;if(t.count<1)return;for(var r=0;r<t.count;r++){var n=new e;n.position.set(t.position.x,t.position.y),n.velocity.addDirection(c.Random.range(-t.angleWidth/2,t.angleWidth/2),t.speed*c.Random.range(.5,1.5)),n.color=t.color,n.size=t.size,n.duration=t.duration}}else o.Game.display.fillRect(this.position.x,this.position.y,this.size,this.size,this.color),this.age>this.duration&&this.destroy()},e}(s.Actor)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4),i=r(5),o=r(13),a=r(23),s=function(){function t(){this.volume=1,t.sounds||(t.sounds=[]),t.sounds.push(this),this.volume=1}return t.initialize=function(){try{this.context=new AudioContext,this.gainNode=this.context.createGain(),this.gainNode.gain.value=n.Config.soundVolume,this.gainNode.connect(this.context.destination),this.enabled=!0}catch(e){t.enabled=!1}this.playInterval=60/n.Config.soundTempo,this.scheduleInterval=1/n.Config.fps*2,this.quantize=.5,this.clear(),this.initDrumParams(),this.initDrumPatterns(),this.random=new i.Random},t.setSeed=function(t){this.random.seed(t)},t.update=function(){if(t.enabled){var e=t.context.currentTime,r=e+t.scheduleInterval;this.sounds.forEach(function(t){t.update(e,r)})}},t.clear=function(){this.sounds=[]},t.initDrumParams=function(){this.drumParameters=[["sine",0,3,0,.174,.15,.278,20,528,2400,-.668,0,0,.01,3e-4,0,0,0,.5,-.26,0,.1,.09,1,0,0,.124,0],["square",0,2,0,0,0,.1,20,400,2e3,-1,0,0,0,.5,0,0,0,.5,-.5,0,0,.5,1,0,0,.75,-1],["noise",0,2,0,0,0,.1,1300,500,2400,1,-1,1,40,1,0,1,0,0,0,0,.75,.25,1,-1,1,.25,-1],["noise",0,2,0,0,0,.05,2400,2400,2400,0,-1,0,0,0,-1,0,0,0,0,0,-.15,.1,1,1,0,1,1],["noise",0,2,0,.036,0,.286,20,986,2400,-.644,0,0,.01,3e-4,0,0,0,0,0,0,0,0,1,0,0,0,0],["saw",0,1,0,.114,0,.264,20,880,2400,-.6,0,0,.01,3e-4,0,0,0,.5,-.362,0,0,0,1,0,0,0,0],["synth",0,2,0,.24,.039,.188,328,1269,2400,-.888,0,0,.01,3e-4,0,0,0,.473,.166,0,.17,.188,1,0,0,.162,0]]},t.initDrumPatterns=function(){this.drumPatterns=["0000010000000001","0000100000001000","0000100100001000","0000100001001000","0000101111001000","0000100100101000","0000100000001010","0001000001000101","0010001000100010","0010001000100010","0100000010010000","1000100010001000","1010010010100101","1101000001110111","1000100000100010","1010101010101010","1000100011001000","1111000001110110","1111101010111010"]},t.generateParams=function(e,r,n){void 0===n&&(n=.5);for(var o=0==e?t.random:new i.Random(e),a=r.length,s=r[o.rangeInt(0,a-1)].concat(),u=s.length;o.value()<n;)for(var c=r[o.rangeInt(0,a-1)],h=1;h<u-1;h++){var l=o.value();s[h]=s[h]*l+c[h]*(1-l)}return s},t.generateDrumParams=function(t){return void 0===t&&(t=0),this.generateParams(t,this.drumParameters)},t.generateDrumPattern=function(e){void 0===e&&(e=0);for(var r=0==e?t.random:new i.Random(e),n=this.drumPatterns.length,o=r.rangeInt(0,n-1),a=this.drumPatterns[o],s=a.length,u=[],c=0;c<s-1;c++){var h=a.charAt(c);u.push("1"==h)}for(;r.value()<.5;)for(var l=r.rangeInt(0,n-1),f=this.drumPatterns[l],p=0;p<s-1;p++){var d=1==f.charAt(p);u[p]=!u[p]!=!d}var y="";return u.forEach(function(t){y+=t?"1":"0"}),y},t.prototype.calculateNextScheduledTime=function(){for(var e=t.playInterval*this.patternInterval,r=0;r<100;r++){this.scheduledTime+=e;var n=this.pattern.charAt(this.patternIndex);if(this.patternIndex=(this.patternIndex+1)%this.pattern.length,"1"==n)break}},t.prototype.playAt=function(e){var r=t.context.createBufferSource();r.buffer=this.buffer,r.connect(t.gainNode),r.start(e)},t.prototype.update=function(e,r){if(this.oneShot){this.oneShot=null;var n=t.playInterval*t.quantize,i=Math.ceil(e/n)*n;(!this.playedTime||i>this.playedTime)&&(this.playAt(i),this.playedTime=i)}if(this.isPlayingLoop){for(this.scheduledTime||(this.scheduledTime=Math.ceil(e/t.playInterval)*t.playInterval-t.playInterval*this.patternInterval,this.patternIndex=0,this.calculateNextScheduledTime());this.scheduledTime<e;)this.calculateNextScheduledTime();for(;this.scheduledTime<=r;)this.playAt(this.scheduledTime),this.calculateNextScheduledTime()}},t.prototype.setFromParams=function(e){return t.enabled?(e[2]*=this.volume,this.buffer=function(t,e){for(var r=a.arrayToParams(e),n=o.generate(r),i=t.createBuffer(1,n.length,44100),s=i.getChannelData(0),u=0;u<s.length;u++)s[u]=n[u];return i}(t.context,e),this):this},t.prototype.setPattern=function(t,e){return void 0===e&&(e=.25),this.pattern=t,this.patternInterval=e,this},t.prototype.playNow=function(){this.playAt(0)},t.prototype.play=function(){return this.oneShot=!0,this},t.prototype.playPattern=function(){return this.isPlayingLoop=!0,this.scheduledTime=null,this},t.prototype.remove=function(){var e=t.sounds.indexOf(this);e>-1&&t.sounds.splice(e,1)},t.sounds=[],t}();e.Sound=s},function(t,e,r){var n,i;n=this,i=function(){"use strict";var t={};return function(t){this.SampleRate=t||44100;var e=this.SampleRate,r=2*e,n=String.fromCharCode,i="data:audio/wav;base64,",o=function(t){var n;return c(["RIFF",36+(n=t.length),"WAVEfmt ",16,1,1,e,r,2,16,"data",n,t],"s4s4224422s4s")};this.make=function(t){return new Audio(i+btoa(o(p(t))))},this.makeWaveFile=function(t){h(i+btoa(o(p(t))))};var a,s,u=function(t,e){return e?n(255&t)+u(t>>8,e-1):""},c=function(t,e){var r="";for(s=0;s<t.length;s++)r+="s"==e[s]?t[s]:u(t[s],e.charCodeAt(s)-48);return r},h=function(t){document.location.href=t},l=Math.sin,f=2*Math.PI;this.toTime=function(t){return t/e},this.toSamples=function(t){return t*e};var p=function(t){return function(t){var e="",r=t.length;for(s=0;s<r;s++){var n=32767*t[s]|0;n=n<-32768?-32768:32767<n?32767:n,n+=n<0?65536:0,e+=String.fromCharCode(255&n,n>>8)}return e}(t)};this.adjustVolume=function(t,e){for(s=0;s<t.length;s++)t[s]*=e;return t},this.filter=function(t,e,r,n,i,o,u,c,h,l){for(r=r||1,n=n||t.length,a=t.slice(0),s=r;s<n;s++)a[s]=e(t,a,r,n,s,i,o,u,c,h,l);return a};var d=this.filter;this.filters={lowpass:function(t,e,r,n,i,o){return e[i-1]+o*(t[i]-e[i-1])},lowpassx:function(t,e,r,n,i,o){return e[i-1]+o*(n-i)/(n-r)*(t[i]-e[i-1])},highpass:function(t,e,r,n,i,o){return o*(e[i-1]+t[i]-t[i-1])}};var y=this.filters;this.f={lowpass:function(t,e,r,n){return d(t,y.lowpass,e,r,n)},lowpassx:function(t,e,r,n){return d(t,y.lowpassx,e,r,n)},highpass:function(t,e,r,n){return d(t,y.highpass,e,r,n)}},this.generate=function(t,r,n,i,o,a,u,c,h){var l=r*f/e,p=new Array(0|t);for(s=0;s<t;s++)p[s]=n(s*l,i,o,a,u,c,h);return p};var g=0,v=this.generate;this.generators={noise:function(t){return t%f<4&&(g=2*Math.random()-1),g},uninoise:Math.random,sine:Math.sin,synth:function(t){return l(t)+.5*l(t/2)+.3*l(t/4)},saw:function(t){return 2*(t/f-(t/f+.5|0))},square:function(t,e){return l(t)>e?1:l(t)<e?-1:e}};var m=this.generators;this.g={noise:function(t){return v(t,0,m.noise)},sine:function(t,e){return v(t,e,m.sine)},synth:function(t,e){return v(t,e,m.synth)},saw:function(t,e){return v(t,e,m.saw)},square:function(t,e,r){return v(t,e,m.square,r)}}}.apply(t),t},"object"==typeof t.exports?t.exports=i():n.audio=i()},function(t,e,r){var n,i;n=this,i=function(){"use strict";var t=r(13),e={};return function(){this.createWaves=function(t){var e={};for(var r in t){var n=t[r];e[r]=this.createWave(n)}return e},this.createWave=function(e){var r=this.arrayToParams(e),n=t.generate(r);return audio.make(n)},this.paramsToArray=function(e){for(var r=[],n=t.Parameters.length,i=0;i<n;i++)r.push(e[t.Parameters[i].id]);return r},this.arrayToParams=function(e){for(var r={},n=t.Parameters.length,i=0;i<n;i++)r[t.Parameters[i].id]=e[i];return r}}.apply(e),e},"object"==typeof t.exports?t.exports=i():n.jsfxlib=i()}])});